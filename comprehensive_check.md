# ì½”ë“œ ì ê²€ ê²°ê³¼ ë³´ê³ ì„œ

## âœ… ë¬¸ë²• ê²€ì¦

### Python
- âœ… precheck_packages.py: ë¬¸ë²• ì˜¤ë¥˜ ì—†ìŒ
- âœ… ëª¨ë“ˆ ì„í¬íŠ¸ ì„±ê³µ
- âœ… argparse ì •ìƒ ì‘ë™

### Bash
- âœ… install_offline_packages_smart.sh: ë¬¸ë²• ì˜¤ë¥˜ ì—†ìŒ
- âœ… setup_cluster_full_multihead_offline_smart.sh: ë¬¸ë²• ì˜¤ë¥˜ ì—†ìŒ

---

## ğŸ” ì ì¬ì  ë¬¸ì œ ë¶„ì„

### 1. precheck_packages.py

#### âœ… ì¥ì 
- ëª…í™•í•œ ë°ì´í„° êµ¬ì¡° (dataclass ì‚¬ìš©)
- íƒ€ì… íŒíŠ¸ ì œê³µ
- ì—ëŸ¬ ì²˜ë¦¬ êµ¬í˜„
- ë„ì›€ë§ ì™„ë¹„

#### âš ï¸ ì ì¬ì  ê°œì„  ì‚¬í•­
1. **subprocess ì—ëŸ¬ ì²˜ë¦¬**
   - `dpkg-query`, `pip3 list` ëª…ë ¹ ì‹¤íŒ¨ ì‹œ graceful degradation
   - í˜„ì¬ ì½”ë“œ: try-exceptë¡œ ì²˜ë¦¬ë¨ âœ…

2. **ê²½ë¡œ ì²˜ë¦¬**
   - ìƒëŒ€ ê²½ë¡œì™€ ì ˆëŒ€ ê²½ë¡œ ëª¨ë‘ ì§€ì›
   - pathlib ì‚¬ìš©ìœ¼ë¡œ ì•ˆì „í•¨ âœ…

3. **íŒŒì¼ ì“°ê¸° ê¶Œí•œ**
   - ë¦¬í¬íŠ¸ íŒŒì¼ ìƒì„± ì‹œ ê¶Œí•œ ë¬¸ì œ ê°€ëŠ¥
   - í•´ê²°: ì‚¬ìš©ìê°€ ì“°ê¸° ê°€ëŠ¥í•œ í˜„ì¬ ë””ë ‰í† ë¦¬ì— ìƒì„± âœ…

---

### 2. install_offline_packages_smart.sh

#### âœ… ì¥ì 
- set -euo pipefailë¡œ ì—„ê²©í•œ ì—ëŸ¬ ì²˜ë¦¬
- ìƒ‰ìƒ ì¶œë ¥ìœ¼ë¡œ ê°€ë…ì„± í–¥ìƒ
- ìƒì„¸í•œ í†µê³„ ì •ë³´

#### âš ï¸ ì ì¬ì  ê°œì„  ì‚¬í•­
1. **ë°°ì—´ ì²˜ë¦¬**
   ```bash
   declare -A SKIP_MAP
   ```
   - Bash 4.0+ í•„ìš” (Ubuntu 22.04ëŠ” Bash 5.1 ì‚¬ìš©) âœ…

2. **dpkg-deb ì˜ì¡´ì„±**
   - dpkg-deb ëª…ë ¹ í•„ìš”
   - Ubuntuì—ëŠ” ê¸°ë³¸ ì„¤ì¹˜ë˜ì–´ ìˆìŒ âœ…

---

### 3. setup_cluster_full_multihead_offline_smart.sh

#### âœ… ì¥ì 
- ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸ì™€ í˜¸í™˜ì„± ìœ ì§€
- ìƒˆë¡œìš´ ê¸°ëŠ¥ ì˜µì…˜ìœ¼ë¡œ ì¶”ê°€
- fallback ë¡œì§ êµ¬í˜„

#### âš ï¸ ì ì¬ì  ê°œì„  ì‚¬í•­
1. **ìŠ¤í¬ë¦½íŠ¸ ì¡´ì¬ í™•ì¸**
   ```bash
   if [ -f "$SMART_INSTALLER" ]; then
       # ìŠ¤ë§ˆíŠ¸ ì„¤ì¹˜
   else
       # fallback
   fi
   ```
   - êµ¬í˜„ë¨ âœ…

---

## ğŸ§ª ì‹¤ì œ í™˜ê²½ í…ŒìŠ¤íŠ¸ í•„ìš” ì‚¬í•­

### ì‹œë‚˜ë¦¬ì˜¤ 1: Critical íŒ¨í‚¤ì§€ ê°ì§€
```bash
# í…ŒìŠ¤íŠ¸ ì¤€ë¹„
cd offline_packages/apt_packages
cp systemd_*.deb test_systemd.deb

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python3 ../../offline_packages/precheck_packages.py --deb-dir .

# ì˜ˆìƒ ê²°ê³¼: Critical ì´ìŠˆ ê°ì§€ â†’ exit 1
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: Skip ë¦¬ìŠ¤íŠ¸ ìƒì„±
```bash
# ë§ì€ íŒ¨í‚¤ì§€ê°€ ì´ë¯¸ ì„¤ì¹˜ëœ ì‹œìŠ¤í…œì—ì„œ ì‹¤í–‰
python3 offline_packages/precheck_packages.py \
    --deb-dir offline_packages/apt_packages

# ì˜ˆìƒ: apt_skip_list.txt ìƒì„±
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: í†µí•© ì‹¤í–‰
```bash
sudo ./setup_cluster_full_multihead_offline_smart.sh --dry-run
```

---

## ğŸ› ë°œê²¬ëœ ì‹¤ì œ ë¬¸ì œ

### ì—†ìŒ!

ëª¨ë“  ì½”ë“œëŠ” ë¬¸ë²•ì ìœ¼ë¡œ ì˜¬ë°”ë¥´ê³ , ì—ëŸ¬ ì²˜ë¦¬ê°€ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] Python ë¬¸ë²• ê²€ì¦
- [x] Bash ë¬¸ë²• ê²€ì¦
- [x] argparse ë™ì‘ í™•ì¸
- [x] ì—ëŸ¬ ë©”ì‹œì§€ ì¶œë ¥ í™•ì¸
- [x] Help ë©”ì‹œì§€ í™•ì¸
- [x] ê¶Œí•œ ì²´í¬ í™•ì¸
- [x] ê²½ë¡œ ì²˜ë¦¬ í™•ì¸
- [x] ë°°ì—´ ì‚¬ìš© (Bash 4.0+) í™•ì¸
- [x] subprocess ì—ëŸ¬ ì²˜ë¦¬ í™•ì¸
- [x] Fallback ë¡œì§ í™•ì¸

---

## âœ… ìµœì¢… íŒì •

**ëª¨ë“  ì½”ë“œëŠ” ë¬¸ì œ ì—†ìŠµë‹ˆë‹¤!**

ì‹¤ì œ ì‚¬ìš© ì „ ê¶Œì¥ ì‚¬í•­:
1. í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ë¨¼ì € ì‹¤í–‰
2. --dry-run ì˜µì…˜ìœ¼ë¡œ ê³„íš í™•ì¸
3. ë¦¬í¬íŠ¸ë¥¼ ë°˜ë“œì‹œ ê²€í† 

