# ì˜¤í”„ë¼ì¸ HPC í´ëŸ¬ìŠ¤í„° ì„¤ì¹˜ ê°€ì´ë“œ

> **ë²„ì „**: 2.0
> **ìž‘ì„±ì¼**: 2025-11-18
> **ëŒ€ìƒ**: í—¤ë“œ ë…¸ë“œë§Œ ì¸í„°ë„·ì´ ê°€ëŠ¥í•˜ê³ , ê³„ì‚° ë…¸ë“œëŠ” ì¸í„°ë„·ì´ ì°¨ë‹¨ëœ í™˜ê²½

---

## ðŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­](#ì‹œìŠ¤í…œ-ìš”êµ¬ì‚¬í•­)
3. [Phase 0: ì‚¬ì „ íŒ¨í‚¤ì§• (ì¸í„°ë„· í•„ìš”)](#phase-0-ì‚¬ì „-íŒ¨í‚¤ì§•-ì¸í„°ë„·-í•„ìš”)
4. [Phase 1: í—¤ë“œ ë…¸ë“œ ì„¤ì¹˜ (ì˜¤í”„ë¼ì¸)](#phase-1-í—¤ë“œ-ë…¸ë“œ-ì„¤ì¹˜-ì˜¤í”„ë¼ì¸)
5. [Phase 2: ê³„ì‚° ë…¸ë“œ ë°°í¬ (ì˜¤í”„ë¼ì¸)](#phase-2-ê³„ì‚°-ë…¸ë“œ-ë°°í¬-ì˜¤í”„ë¼ì¸)
6. [Phase 3: ê²€ì¦ ë° í…ŒìŠ¤íŠ¸](#phase-3-ê²€ì¦-ë°-í…ŒìŠ¤íŠ¸)
7. [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)
8. [FAQ](#faq)

---

## ê°œìš”

### ì™œ ì˜¤í”„ë¼ì¸ ì„¤ì¹˜ê°€ í•„ìš”í•œê°€?

ì‹¤ì œ í”„ë¡œë•ì…˜ HPC í´ëŸ¬ìŠ¤í„° í™˜ê²½ì—ì„œëŠ”:
- **ë³´ì•ˆ ì •ì±…**: ê³„ì‚° ë…¸ë“œëŠ” ì™¸ë¶€ ì¸í„°ë„· ì ‘ê·¼ì´ ì°¨ë‹¨ë¨
- **ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨ì„±**: ìˆ˜ì‹­~ìˆ˜ë°± ê°œ ë…¸ë“œê°€ ë™ì¼í•œ íŒ¨í‚¤ì§€ë¥¼ ê°œë³„ ë‹¤ìš´ë¡œë“œí•˜ë©´ ëŒ€ì—­í­ ë‚­ë¹„
- **ë¹Œë“œ ì‹œê°„**: ê° ë…¸ë“œì—ì„œ Slurmì„ ì»´íŒŒì¼í•˜ë©´ ë…¸ë“œë‹¹ 15-20ë¶„ ì†Œìš”

### ì˜¨ë¼ì¸ vs ì˜¤í”„ë¼ì¸ ì„¤ì¹˜ ë¹„êµ

| í•­ëª© | ì˜¨ë¼ì¸ ì„¤ì¹˜ | ì˜¤í”„ë¼ì¸ ì„¤ì¹˜ |
|------|------------|--------------|
| **ì¸í„°ë„· í•„ìš”** | ëª¨ë“  ë…¸ë“œ | í—¤ë“œ ë…¸ë“œë§Œ (ì‚¬ì „ ì¤€ë¹„ ì‹œ) |
| **Slurm ë¹Œë“œ** | ê° ë…¸ë“œ 15ë¶„ | í—¤ë“œ ë…¸ë“œë§Œ 1íšŒ |
| **íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ** | ê° ë…¸ë“œ ë°˜ë³µ | í—¤ë“œ ë…¸ë“œ 1íšŒ |
| **ë…¸ë“œë‹¹ ì„¤ì¹˜ ì‹œê°„** | 20-30ë¶„ | 3-5ë¶„ |
| **10ë…¸ë“œ ì´ ì‹œê°„** | 3-5ì‹œê°„ | 1-1.5ì‹œê°„ |
| **ë„¤íŠ¸ì›Œí¬ íŠ¸ëž˜í”½** | N Ã— íŒ¨í‚¤ì§€ í¬ê¸° | 1 Ã— íŒ¨í‚¤ì§€ í¬ê¸° |

---

## Part 1: ì˜¨ë¼ì¸ í™˜ê²½ì—ì„œ íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ

### ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­
- Ubuntu 22.04 LTS
- ë””ìŠ¤í¬ ê³µê°„: ìµœì†Œ 2GB
- ì¸í„°ë„· ì—°ê²°: í•„ìˆ˜

### 1-1. ì €ìž¥ì†Œ ë‹¤ìš´ë¡œë“œ (ì˜¨ë¼ì¸)

```bash
cd /home/koopark/claude/KooSlurmInstallAutomationRefactory
```

### 1-2. íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ ì‹¤í–‰

```bash
./download_packages_all.sh
```

**ì‹¤í–‰ ë‚´ìš©:**
1. Slurm 23.11.10 ì†ŒìŠ¤ ë‹¤ìš´ë¡œë“œ
2. í•„ìˆ˜ .deb íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ (ì•½ 200-300ê°œ)
3. Python íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ (PyYAML, paramiko ë“±)
4. ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ ë°±ì—…
5. ì••ì¶• ì•„ì¹´ì´ë¸Œ ìƒì„±

**ì†Œìš” ì‹œê°„:** ì•½ 5-10ë¶„ (ë„¤íŠ¸ì›Œí¬ ì†ë„ì— ë”°ë¼ ë‹¤ë¦„)

### 1-3. ë‹¤ìš´ë¡œë“œ ê²°ê³¼ í™•ì¸

```bash
ls -lh slurm-offline-packages-*.tar.gz
```

ì¶œë ¥ ì˜ˆì‹œ:
```
-rw-r--r-- 1 user user 850M Oct 23 12:34 slurm-offline-packages-20251023.tar.gz
```

---

## Part 2: ì˜¤í”„ë¼ì¸ í™˜ê²½ìœ¼ë¡œ ì „ì†¡

### 2-1. USBë¡œ ë³µì‚¬

```bash
# USB ë§ˆìš´íŠ¸
sudo mount /dev/sdb1 /mnt/usb

# íŒŒì¼ ë³µì‚¬
cp slurm-offline-packages-20251023.tar.gz /mnt/usb/

# ì–¸ë§ˆìš´íŠ¸
sudo umount /mnt/usb
```

### 2-2. SCPë¡œ ì „ì†¡ (ë„¤íŠ¸ì›Œí¬ ê°€ëŠ¥í•œ ê²½ìš°)

```bash
scp slurm-offline-packages-20251023.tar.gz user@offline-machine:/tmp/
```

---

## Part 3: ì˜¤í”„ë¼ì¸ í™˜ê²½ì—ì„œ ì„¤ì¹˜

### ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­
- Ubuntu 22.04 LTS
- ë””ìŠ¤í¬ ê³µê°„: ìµœì†Œ 5GB
- ì¸í„°ë„· ì—°ê²°: **ë¶ˆí•„ìš”**

### 3-1. ì••ì¶• í•´ì œ

```bash
cd /tmp
tar -xzf slurm-offline-packages-20251023.tar.gz
cd KooSlurmInstallAutomationRefactory
```

### 3-2. ì˜¤í”„ë¼ì¸ ì„¤ì¹˜ ì‹¤í–‰

```bash
./setup_cluster_full_offline.sh
```

### 3-3. ì„¤ì¹˜ ë‹¨ê³„

ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ìŒ ë‹¨ê³„ë¥¼ ìžë™ìœ¼ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤:

1. âœ… **íŒ¨í‚¤ì§€ ê²€ì¦**: packages/ ë””ë ‰í† ë¦¬ í™•ì¸
2. âœ… **Python í™˜ê²½**: venv ìƒì„± ë° í™œì„±í™”
3. âœ… **Python íŒ¨í‚¤ì§€**: ì˜¤í”„ë¼ì¸ pip ì„¤ì¹˜
4. âœ… **ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€**: .deb íŒŒì¼ ì„¤ì¹˜
5. âœ… **ì‚¬ìš©ìž ìƒì„±**: slurm, munge ì‚¬ìš©ìž
6. âœ… **Slurm ë¹Œë“œ**: ì†ŒìŠ¤ì—ì„œ ì»´íŒŒì¼ (15-20ë¶„)
7. âœ… **Munge ì„¤ì •**: ì¸ì¦ ì‹œìŠ¤í…œ
8. âœ… **systemd ì„œë¹„ìŠ¤**: slurmctld, slurmd ì„œë¹„ìŠ¤ íŒŒì¼
9. âœ… **slurmdbd ì„¤ì¹˜**: Accounting ë°ì´í„°ë² ì´ìŠ¤ (ì„ íƒ)
10. âœ… **/etc/hosts ì„¤ì •**: ëª¨ë“  ë…¸ë“œ í˜¸ìŠ¤íŠ¸ëª… ë“±ë¡
11. âœ… **ê³„ì‚° ë…¸ë“œ ì„¤ì¹˜**: ì›ê²© ë…¸ë“œì— Slurm ì„¤ì¹˜
12. âœ… **ì„¤ì • íŒŒì¼ ìƒì„±**: slurm.conf, cgroup.conf
13. âœ… **ì„¤ì • íŒŒì¼ ë°°í¬**: ëª¨ë“  ë…¸ë“œì— ì„¤ì • ë³µì‚¬
14. âœ… **ì„œë¹„ìŠ¤ ì‹œìž‘**: slurmctld, slurmd ì‹œìž‘

**ì†Œìš” ì‹œê°„:** ì•½ 30-40ë¶„ (ë¹Œë“œ ì‹œê°„ í¬í•¨)

---

## Part 4: ì„¤ì¹˜ ê²€ì¦

### 4-1. ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸

```bash
# ì»¨íŠ¸ë¡¤ëŸ¬
sudo systemctl status slurmctld

# ê³„ì‚° ë…¸ë“œ (ì›ê²©)
ssh node001 "sudo systemctl status slurmd"
```

### 4-2. í´ëŸ¬ìŠ¤í„° ìƒíƒœ í™•ì¸

```bash
sinfo
```

ì •ìƒ ì¶œë ¥ ì˜ˆì‹œ:
```
PARTITION AVAIL  TIMELIMIT  NODES  STATE NODELIST
normal*      up 7-00:00:00      2   idle node[001-002]
viz          up 60-00:00:0      1   idle viz-node001
```

### 4-3. ë…¸ë“œ ìƒì„¸ ì •ë³´

```bash
sinfo -N
```

ì¶œë ¥ ì˜ˆì‹œ:
```
NODELIST     NODES PARTITION STATE
node001          1   normal* idle
node002          1   normal* idle
viz-node001      1       viz idle
```

### 4-4. í…ŒìŠ¤íŠ¸ ìž‘ì—… ì œì¶œ

```bash
cat > test_job.sh <<'EOF'
#!/bin/bash
#SBATCH --job-name=test
#SBATCH --output=test_%j.out
#SBATCH --cpus-per-task=2
#SBATCH --mem=1G

echo "Test job running on $(hostname)"
echo "CPUs: $SLURM_CPUS_PER_TASK"
sleep 10
echo "Job completed successfully"
EOF

sbatch test_job.sh
squeue
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: íŒ¨í‚¤ì§€ ëˆ„ë½

**ì¦ìƒ:**
```
dpkg: dependency problems prevent configuration
```

**í•´ê²°:**
```bash
cd packages/deb
sudo dpkg -i *.deb
sudo apt-get install -f -y
```

### ë¬¸ì œ 2: Slurm ë¹Œë“œ ì‹¤íŒ¨

**ì¦ìƒ:**
```
configure: error: systemd support requested but libsystemd not found
```

**í•´ê²°:**
```bash
# ì˜ì¡´ì„± í™•ì¸
dpkg -l | grep libsystemd-dev

# ëˆ„ë½ ì‹œ packages/debì—ì„œ ìž¬ì„¤ì¹˜
cd packages/deb
sudo dpkg -i libsystemd-dev*.deb
```

### ë¬¸ì œ 3: slurmd ë“±ë¡ ì‹¤íŒ¨

**ì¦ìƒ:**
```
error: Unable to register: Unable to contact slurm controller
```

**í•´ê²°:**
```bash
# 1. /etc/hosts í™•ì¸
cat /etc/hosts | grep smarttwincluster

# 2. ì—†ìœ¼ë©´ ì¶”ê°€
echo "192.168.122.1 smarttwincluster" | sudo tee -a /etc/hosts

# 3. slurmd ìž¬ì‹œìž‘
sudo systemctl restart slurmd
```

### ë¬¸ì œ 4: ë…¸ë“œê°€ DOWN ìƒíƒœ

**ì¦ìƒ:**
```
NODELIST     STATE
node001      down
```

**í•´ê²°:**
```bash
# ë…¸ë“œ í™œì„±í™”
scontrol update NodeName=node001 State=RESUME

# ìƒíƒœ í™•ì¸
sinfo
```

---

## ì˜¨ë¼ì¸ vs ì˜¤í”„ë¼ì¸ ë¹„êµ

| í•­ëª© | setup_cluster_full.sh | setup_cluster_full_offline.sh |
|------|----------------------|------------------------------|
| ì¸í„°ë„· í•„ìš” | âœ… í•„ìˆ˜ | âŒ ë¶ˆí•„ìš” |
| ì‚¬ì „ ì¤€ë¹„ | ì—†ìŒ | download_packages_all.sh ì‹¤í–‰ |
| ì„¤ì¹˜ ì‹œê°„ | 30-40ë¶„ | 30-40ë¶„ (ë™ì¼) |
| íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ | ì‹¤í–‰ ì¤‘ | ì‚¬ì „ ì™„ë£Œ |
| ê¸°ì¡´ íŒŒì¼ ìˆ˜ì • | ì—†ìŒ | ì—†ìŒ |
| í˜¸í™˜ì„± | ì™„ì „ ë™ì¼ | ì™„ì „ ë™ì¼ |

---

## FAQ

### Q1: packages/ ë””ë ‰í† ë¦¬ í¬ê¸°ëŠ”?

**A:** ì••ì¶• ì „ ì•½ 800MB - 1.2GB, ì••ì¶• í›„ ì•½ 400MB - 600MB

### Q2: ë‹¤ë¥¸ Ubuntu ë²„ì „ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œê°€ìš”?

**A:** Ubuntu 22.04 ê¸°ì¤€ìœ¼ë¡œ íŒ¨í‚¤ì§€ê°€ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤.
ë‹¤ë¥¸ ë²„ì „(20.04, 24.04)ì—ì„œëŠ” íŒ¨í‚¤ì§€ í˜¸í™˜ì„± ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

### Q3: íŒ¨í‚¤ì§€ë¥¼ ì—…ë°ì´íŠ¸í•˜ë ¤ë©´?

**A:** ì˜¨ë¼ì¸ í™˜ê²½ì—ì„œ `./download_packages_all.sh`ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì„¸ìš”.

### Q4: ê¸°ì¡´ ì˜¨ë¼ì¸ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ì™€ ì°¨ì´ì ì€?

**A:**
- `setup_cluster_full.sh`: ì¸í„°ë„·ì—ì„œ ì‹¤ì‹œê°„ ë‹¤ìš´ë¡œë“œ
- `setup_cluster_full_offline.sh`: packages/ì—ì„œ ì½ìŒ
- ê¸°ëŠ¥ê³¼ ê²°ê³¼ëŠ” ì™„ì „ížˆ ë™ì¼í•©ë‹ˆë‹¤

### Q5: ì¼ë¶€ ë…¸ë“œë§Œ ì˜¤í”„ë¼ì¸ì¸ ê²½ìš°?

**A:**
ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” `setup_cluster_full.sh` (ì˜¨ë¼ì¸)ìœ¼ë¡œ ì„¤ì¹˜í•˜ê³ ,
ì˜¤í”„ë¼ì¸ ë…¸ë“œëŠ” packages/ë§Œ ë³µì‚¬í•˜ì—¬ ì„¤ì¹˜ ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## ë¶€ë¡: packages/ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
packages/
â”œâ”€â”€ deb/                          # .deb íŒ¨í‚¤ì§€ (200-300ê°œ)
â”‚   â”œâ”€â”€ build-essential_*.deb
â”‚   â”œâ”€â”€ gcc_*.deb
â”‚   â”œâ”€â”€ munge_*.deb
â”‚   â”œâ”€â”€ libsystemd-dev_*.deb
â”‚   â””â”€â”€ ...
â”œâ”€â”€ source/                       # ì†ŒìŠ¤ ì½”ë“œ
â”‚   â””â”€â”€ slurm-23.11.10.tar.bz2
â”œâ”€â”€ python/                       # Python íŒ¨í‚¤ì§€
â”‚   â”œâ”€â”€ PyYAML-*.whl
â”‚   â”œâ”€â”€ paramiko-*.whl
â”‚   â””â”€â”€ ...
â”œâ”€â”€ scripts/                      # ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ my_cluster.yaml
â”‚   â”œâ”€â”€ install_slurm_cgroup_v2.sh
â”‚   â”œâ”€â”€ install_munge_auto.sh
â”‚   â”œâ”€â”€ complete_slurm_setup.py
â”‚   â””â”€â”€ src/
â””â”€â”€ README.md
```

---

## ì§€ì› ë° ë¬¸ì˜

ë¬¸ì œ ë°œìƒ ì‹œ:
1. ë¡œê·¸ í™•ì¸: `/var/log/slurm/slurmctld.log`
2. systemd ë¡œê·¸: `sudo journalctl -u slurmctld -n 100`
3. GitHub Issues: https://github.com/anthropics/claude-code/issues

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸:** 2025-10-23
**Slurm ë²„ì „:** 23.11.10
**ëŒ€ìƒ OS:** Ubuntu 22.04 LTS
